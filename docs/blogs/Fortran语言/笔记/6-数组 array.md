# 06-æ•°ç»„array

## åŸºæœ¬ä½¿ç”¨

### ä¸€ç»´æ•°ç»„

æ•°ç»„å¯ä»¥ä¸€æ¬¡å£°æ˜å¤„ä¸€é•¿ä¸²ç›¸åŒæ•°æ®ç±»å‹çš„å˜é‡

å£°æ˜æ•°ç»„çš„è¯­æ³•ï¼ˆä»¥éè‡ªå®šä¹‰ç±»å‹integerä¸ºä¾‹ï¼‰
- `integer a(10)`
- `integer,dimension(10) :: a` : å…ˆå£°æ˜aæ˜¯æ•´å‹ï¼Œå†å£°æ˜aæ˜¯å¤§å°ä¸º10çš„æ•°ç»„

è‡ªå®šä¹‰ç±»å‹çš„æ•°ç»„å£°æ˜
- `type(person)::a(10)` : ç”¨personæ–°ç±»å‹æ¥å£°æ˜æ•°ç»„

è‡ªå®šä¹‰ç±»å‹æ•°ç»„çš„è®¿é—®
- `a(2)%name`ï¼šè®¿é—®æ•°ç»„çš„ç¬¬2ä¸ªè‡ªå®šä¹‰å…ƒç´ çš„nameå±æ€§


### äºŒç»´æ•°ç»„

å£°æ˜äºŒç»´æ•°ç»„ï¼ˆä»¥éè‡ªå®šä¹‰ç±»å‹integerä¸ºä¾‹ï¼‰
- `integer a(3,3)`
- `integer,dimension(3,3) :: a`

è®¿é—®ï¼š`a(1,2)`

### å¤šç»´æ•°ç»„

fortran æœ€å¤šå¯ä»¥å£°æ˜é«˜è¾¾7ç»´çš„æ•°ç»„

æ¯ä¸€ä¸ªç»´åº¦éƒ½æœ‰å¯¹åº”çš„å¤§å°

```fortran
integer a(D1,D2,â€¦,Dn) ! nç»´æ•°ç»„
a(I1,I2,â€¦,In) ! ä½¿ç”¨nç»´æ•°ç»„æ—¶ï¼Œè¦ç»™nä¸ªåæ ‡å€¼
```

### ç‰¹æ®Šçš„æ•°ç»„å£°æ˜

åœ¨æ²¡æœ‰ç‰¹åˆ«èµ‹å€¼çš„æƒ…å†µä¸‹ï¼Œæ•°ç»„çš„ç´¢å¼•å€¼éƒ½æ˜¯ä»1å¼€å§‹çš„ï¼ˆå³æ•°ç»„çš„ä¸‹ç•Œé»˜è®¤ä¸º1ï¼‰

integer a(5) ===> a(1)ã€a(2)ã€a(3)ã€a(4)ã€a(5)

å¯ä»¥ç‰¹åˆ«èµ‹å€¼æ•°ç»„çš„åæ ‡å€¼çš„ä½¿ç”¨èŒƒå›´ï¼šï¼ˆï¼‰æŒ‡çš„æ˜¯**é—­åŒºé—´**

- `integer a(0:5)`  ===> a(0)ã€a(1)ã€a(2)ã€a(3)ã€a(4)ã€a(5)
- `integer a(-3:3)` ===> a(-3)ã€a(-2)ã€a(-1)ã€a(0)ã€a(1)ã€a(2)ã€a(3)
- `integer a(5, 0:5)`===> a(1~5, 0~5)
- `integer b(2:3, -1:3)` ===> b(2~3, -1~3)

## æ•°ç»„å†…å®¹çš„è®¾ç½®

### èµ‹åˆå€¼

#### data è¯­å¥

åœ¨Fortranä¸­ï¼Œ`DATA`è¯­å¥ç”¨äºåœ¨ç¨‹åºä¸­ä¸ºå˜é‡èµ‹åˆå§‹å€¼ã€‚`DATA`è¯­å¥çš„è¯­æ³•å¦‚ä¸‹ï¼š

```fortran
DATA variable1 / value1 /, variable2 / value2 /, ...
```

å…¶ä¸­ï¼Œ`variable1`, `variable2`, ... æ˜¯è¦èµ‹å€¼çš„å˜é‡ï¼Œ`value1`, `value2`, ... æ˜¯å¯¹åº”çš„åˆå§‹å€¼ã€‚

```fortran
program dataexample
  integer :: x, y, z
  real :: a, b, c
  
  data x / 10 /, y / 20 /, z / 30 /
  data a / 1.5 /, b / 2.5 /, c / 3.5 /
  
  write(*, *) "x =", x
  write(*, *) "y =", y
  write(*, *) "z =", z
  
  write(*, *) "a =", a
  write(*, *) "b =", b
  write(*, *) "c =", c
end program dataexample
```

#### æ•°ç»„å†…å®¹é€šè¿‡dataæ¥åˆå§‹åŒ–

ä¾‹å¦‚
```fortran
program main
    implicit none
    integer a(5)
    integer b(5)
    integer c(5)
    data a /1,2,3,4,5/
    ! ä¸åšä»»ä½•èµ‹åˆå€¼æ“ä½œ
    data c/5*0/
    print *,a
    print *,b
    print *,c
end
```

![image.png|center|800](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725163647.png)

#### é€šè¿‡éšå«å¼å¾ªç¯æ¥èµ‹å€¼

ä¾‹å¦‚ï¼š

```fortran
integer a(5)
integer i
data (a(i),i=2,4) /2,3,4/
```

åˆå€¼çš„è®¾ç½®ç»“æœä¸ºï¼š2ï¼Œ3ï¼Œ4 ä½ç½®ä¸Šçš„æ•°ç»„å€¼åˆ†åˆ«ä¸º 2ï¼Œ3ï¼Œ4

```fortran
program main
	integer a(8)
	integer i
	data (a(i),i=2,4) /2,3,4/
	print *,a
	print *,(a(i),i=2,4)
end

```

![image.png|center|800](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725164604.png)

æ³¨æ„ğŸ“¢ï¼š
- éšå«å¼`(a(i),i=min,max,stride)`
- ä¹Ÿå¯ä»¥è¿›è¡Œå¤šå±‚åµŒå¥—
	- `((a(i,j),j=1,2),i=1,2)`

####  åœ¨Fortran90ä¸­èµ‹åˆå§‹å€¼

å¯ä»¥çœç•¥ data

`integer a(5) = (/ 1,2,3,4,5 /)` ! æ‹¬å·å’Œé™¤å·ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼

ç›´æ¥æŠŠåˆå€¼å†™åœ¨å£°æ˜åé¢æ—¶ï¼Œæ¯ä¸ªå…ƒç´ éƒ½è¦ç»™å®šåˆå§‹å€¼

è€Œä¸”ï¼Œç›´æ¥èµ‹å€¼çš„`(/  ...  /) `çš„ `...` ä¸­ä¹Ÿæ”¯æŒ**éšå«å¼å¾ªç¯**

``` fortran
program main
    integer :: i
    integer :: a(5) = (/ 1,2,3,4,5 /)
    integer :: b(5) = (/ 1,(0,i=2,4),5 /)
    integer :: c(5) = 100 ! ä¸€æ¬¡æŠŠæ•´ä¸ªæ•°ç»„å†…å®¹è®¾ç½®ä¸ºåŒä¸€ä¸ªæ•°å€¼
    print *,a
    print *,b
    print *,c
end
```

![image.png|center|800](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725165439.png)

### å¯¹æ•´ä¸ªæ•°ç»„çš„æ“ä½œ

fortran 90 å¯ä»¥é€šè¿‡ç®€å•çš„å‘½ä»¤æ¥æ“ä½œæ•°ç»„

- `a=5`
	- aæ˜¯ä¸€ä¸ªä»»æ„ç»´æ•°åŠå¤§å°çš„æ•°ç»„ã€‚
	- è¿™ä¸ªå‘½ä»¤æ˜¯æŠŠæ•°ç»„açš„æ¯ä¸ªå…ƒç´ çš„å€¼éƒ½è®¾ç½®ä¸º5ã€‚
	- ä»¥ä¸€ç»´çš„æƒ…æ³æ¥è¯´ï¼Œå³a(i) = 5
- ` a=(/   1,2,3   /)`
	- a(1)=1, a(2)=2ï¼Œa(3)=3ã€‚
	- ç­‰å·å³è¾¹æ‰€æä¾›çš„æ•°å­—ä¸ªæ•°ï¼Œå¿…é¡»è·Ÿæ•°ç»„açš„å¤§å°ä¸€æ ·
- `a=b`
	- aå’Œbæ˜¯åŒæ ·ç»´æ•°åŠå¤§å°çš„æ•°ç»„ã€‚
	- è¿™ä¸ªå‘½ä»¤ä¼šæŠŠæ•°ç»„aåŒæ ·ä½ç½®å…ƒç´ çš„å†…å®¹è®¾ç½®æˆå’Œæ•°ç»„bä¸€æ ·ã€‚
	- ä»¥ä¸€ç»´çš„æƒ…å†µæ¥è¯´ï¼Œå³$a(i) = b(i)$
- `a=b+c`
	- a,bï¼Œcæ˜¯ä¸‰ä¸ªåŒæ ·ç»´æ•°åŠå¤§å°çš„æ•°ç»„
	- è¿™ä¸ªå‘½ä»¤ä¼šæŠŠæ•°ç»„båŠcä¸­åŒæ ·ä½ç½®çš„æ•°å€¼ç›¸åŠ ï¼Œå¾—åˆ°çš„æ•°å€¼å†æ”¾å›æ•°ç»„aåŒæ ·çš„ä½ç½®ä¸­ã€‚
	- ä»¥äºŒç»´çš„æƒ…å†µæ¥è¯´ï¼Œå³$a(i,j)=b(i,j)+c(i,j)$
- `a=b-c`
	- aï¼Œbï¼Œcæ˜¯ä¸‰ä¸ªåŒæ ·ç»´æ•°åŠå¤§å°çš„æ•°ç»„
	- è¿™ä¸ªå‘½ä»¤ä¼šæŠŠæ•°ç»„båŠcä¸­åŒæ ·ä½ç½®çš„æ•°å€¼ç›¸å‡ï¼Œå¾—åˆ°çš„æ•°å€¼å†æ”¾å›æ•°ç»„a
	- åŒæ ·çš„ä½ç½®ä¸­ã€‚ä»¥äºŒç»´çš„æƒ…æ³æ¥è¯´ï¼Œå³$a(i,j)=b(i,j)-c(i,j)$
- `a=b*c`
	- aï¼Œbï¼Œcæ˜¯ä¸‰ä¸ªåŒæ ·ç»´æ•°åŠå¤§å°çš„æ•°ç»„
	- æ‰§è¡Œåæ•°ç»„açš„æ¯ä¸€ä¸ªå…ƒç´ å€¼ä¸ºç›¸åŒä½ç½®çš„æ•°ç»„bå…ƒç´ ä¹˜ä»¥æ•°ç»„cå…ƒç´ ã€‚
	- ä»¥äºŒç»´çš„æƒ…å†µæ¥è¯´ï¼Œå³$a(i,j)=b(i, j) \times c(i, j)$
- `a=b/c`
	- aï¼Œbï¼Œcæ˜¯ä¸‰ä¸ªåŒæ ·ç»´æ•°åŠå¤§å°çš„æ•°ç»„
	- æ‰§è¡Œåæ•°ç»„açš„æ¯ä¸€ä¸ªå…ƒç´ å€¼ä¸ºç›¸åŒä½ ç½®çš„æ•°ç»„bå…ƒç´ é™¤ä»¥æ•°ç»„Cå…ƒç´ ã€‚
	- ä»¥äºŒç»´çš„æƒ…å†µæ¥è¯´ï¼Œå³$a(i,j) = b(i,j) \div c(i,j)$
- `a=sin(b)`
	- çŸ©é˜µaçš„æ¯ä¸€ä¸ªå…ƒç´ ä¸ºçŸ©é˜µbå…ƒç´ çš„sinå€¼
	- æ•°ç»„bå¿…é¡»æ˜¯å®å‹æ•°ç»„ï¼Œæ‰èƒ½ä½¿ç”¨sinå‡½æ•°ã€‚
	- ä»¥ä¸€ç»´çš„æƒ…å†µæ¥è¯´ï¼Œå³$a(i)=sin(b(i))$
- `a=b>c`
	- a,b,cæ˜¯ä¸‰ä¸ªåŒæ ·ç»´æ•°åŠå¤§å°çš„æ•°ç»„
	- å…¶ä¸­æ•°ç»„aæ˜¯é€»è¾‘å‹æ•°ç»„ï¼Œæ•°ç»„bã€cåˆ™ä¸ºå…ƒç´ é—´å¯ä»¥è¿›è¡Œæ¯”è¾ƒçš„å˜é‡ç±»å‹ã€‚
	- ä»¥ä¸€ç»´æƒ…æ³æ¥è¯´ï¼Œå³ä¸º
```fortran
if (b(i)>c(i)) then 
	a(i)=.true.
else
	a(i)=.false.
endif
```

### å¯¹éƒ¨åˆ†æ•°ç»„çš„æ“ä½œ

å’Œpythonä¸­çš„ç±»ä¼¼ï¼Œfortranä¸­ä½¿ç”¨çš„å‰é—­åé—­åŒºé—´

- `a(3:3)`
	- ä¸a(3ï¼‰ç›¸åŒ
- `a(3:5)=5`
	- æŠŠa(3)~a(5)çš„å†…å®¹è®¾ç½®æˆ5ï¼Œå…¶ä»–å€¼ä¸å˜
- `a(3:)=5`
	- æŠŠa(3)ä¹‹åå…ƒç´ çš„å†…å®¹è®¾ç½®æˆ5ï¼Œå…¶ä»–å€¼ä¸å˜
- `a(3:5)=(/3,4,5/)`
	- è®¾ç½®a(3)=3ï¼Œ a(4)=4, a(5)=5ï¼Œå…¶ä»–å€¼ä¸å˜ã€‚
	- ç­‰å·å·¦è¾¹æ‰€èµ‹å€¼çš„æ•°ç»„å…ƒç´ æ•°ç›®å¿…é¡»è·Ÿç­‰å·å³è¾¹æä¾›çš„æ•°å­—ä¸ªæ•°ç›¸åŒ
- `a(1:5:2)=3`
	- è®¾ç½®a(1)=3, a(3)=3ï¼Œ a(5)=3ã€‚ç±»ä¼¼éšå«å¼å¾ªç¯
- `a(1:10)=a(10:1:-1)`
	- ä½¿ç”¨ç±»ä¼¼éšå«å¼å¾ªç¯çš„æ–¹æ³•æŠŠa(1~10)çš„å†…å®¹ç»™ç¿»è½¬
- `a(:)=b(:,2)`
	- å‡è®¾aå£°æ˜ä¸ºa(5)ï¼Œbå£°æ˜ä¸ºb(5,5)ã€‚
	- ç­‰å·å³è¾¹b(ï¼š,2)æ˜¯å–å‡ºb(1~5,2)è¿™5ä¸ªå…ƒç´ ã€‚
	- è€Œaæ˜¯ä¸€ç»´æ•°ç»„ï¼Œæ‰€ä»¥a(:)å’Œç›´æ¥ä½¿ç”¨aæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æŒ‡a(1~5)è¿™5ä¸ªå…ƒç´ ã€‚
	- åªè¦ç­‰å·ä¸¤è¾¹çš„å…ƒç´ æ•°æ—¥ä¸€æ ·å¤šå°±æˆç«‹ã€‚
	- æ‰§è¡Œç»“æœä¸ºa(i)=b(i,2ï¼‰
- `a(:,:)=b(:,:,1)`
	- å‡è®¾aå£°æ˜ä¸ºa(5,5ï¼‰ï¼Œbå£°æ˜ä¸ºb(5,5,5)ã€‚
	- ç­‰å·å³è¾¹b(;,:1ï¼‰æ˜¯å–å‡ºbï¼ˆ1~5ï¼Œ1~5ï¼Œ1)è¿™25ä¸ªå…ƒç´ ã€‚
	- è€Œaæ˜¯äºŒç»´æ•°ç»„ï¼Œæ‰€ä»¥a(:,:)å’Œç›´æŒ‰ä½¿ç”¨aæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æŒ‡a(1~5,1~5)è¿™25ä¸ªå…ƒç´ ã€‚
	- æ‰§è¡Œç»“æœä¸ºa(i,j)=b(i,j,1)

### where è¯­å¥

fortran 95æ–°æ·»åŠ çš„å†…å®¹

å¯¹æ¯”mysqlçš„è¯­å¥è¿›è¡Œç†è§£

![image.png|center|600](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725175225.png)

![image.png|center|600](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725175249.png)

### forall è¯­å¥

fortran 95 ä½¿ç”¨éšå«å¼å¾ªç¯æ¥ä½¿ç”¨æ•°ç»„çš„ç®—æ³•

![image.png|center|600](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725175421.png)

## æ•°ç»„çš„ä¿å­˜è§„åˆ™

### ä¸€ç»´æ•°ç»„

è¿ç»­å­˜æ”¾

![image.png|center|600](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725175840.png)


### äºŒç»´æ•°ç»„

æŒ‰ç…§åˆ—çš„å¤§å°ï¼Œä»å°å¾€å¤§å¼€å§‹æ’åº

![image.png|center|600](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725175858.png)

æ‰€ä»¥ï¼Œä»¥åå¾ªç¯çš„å†…å±‚å¾ªç¯åº”è¯¥ä»iå¼€å§‹ï¼Œç„¶åå¤–å±‚å¾ªç¯æ˜¯jï¼Œè¿™æ ·å¯ä»¥æé«˜æ•ˆç‡

```fortran
do i=1,4
	do j=1,4
		....
		a(j,i)
	end do
end do
```

### å¤šç»´æ•°ç»„

å…ˆæ”¾å…¥è¾ƒä½ç»´çš„å…ƒç´ ï¼Œå†æ”¾å…¥è¾ƒé«˜ç»´çš„å…ƒç´ 

æœ€å…ˆå˜åŒ–çš„æ˜¯ä½ç»´çš„å…ƒç´ ï¼Œæœ€é«˜ç»´çš„å…ƒç´ ï¼ˆä¸‹æ ‡ï¼‰æœ€åå˜åŒ–ã€‚


![image.png|center|300](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725180236.png)

![image.png|center|600](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725180458.png)

![image.png|center|600](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725180839.png)

### æ•°æ®çš„å­˜å‚¨æ–¹å¼

æ ¹æ®å†…å­˜çš„æ’åˆ—é¡ºåºæ¥è®¾ç½®æ•°å€¼

```fortran
integer :: a(2,2) = (/ 1,2,3,4 /)
!a(1,1)=1,a(2,1)=2,a(1,2)=3,a(2,2)=4
```

![image.png|center|300](https://jsd.cdn.zzko.cn/gh/NEUQer-xing/Markdown_images@master/images-2/20230725193338.png)

## åŠ¨æ€æ•°ç»„

åœ¨Fortranä¸­ï¼Œå¯ä»¥ä½¿ç”¨`allocate`å…³é”®å­—æ¥åŠ¨æ€åˆ†é…æ•°ç»„çš„å†…å­˜ç©ºé—´ã€‚

ç¤ºä¾‹ï¼š

```fortran
program dynamic_array_example
  integer, allocatable :: dynamic_array(:)
  integer :: size, i
  
  ! è·å–æ•°ç»„å¤§å°
  write(*, *) "Enter the size of the array:"
  read(*, *) size
  
  ! åŠ¨æ€åˆ†é…æ•°ç»„å†…å­˜ç©ºé—´
  allocate(dynamic_array(size))
  
  ! åˆå§‹åŒ–æ•°ç»„
  do i = 1, size
    dynamic_array(i) = i
  end do
  
  ! è¾“å‡ºæ•°ç»„å…ƒç´ 
  write(*, *) "Array elements:"
  do i = 1, size
    write(*, *) dynamic_array(i)
  end do
  
  ! é‡Šæ”¾æ•°ç»„å†…å­˜ç©ºé—´
  deallocate(dynamic_array)
  
end program dynamic_array_example
```

åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œå£°æ˜äº†ä¸€ä¸ªå¯åˆ†é…çš„æ•´æ•°æ•°ç»„`dynamic_array`ï¼Œå¹¶æ²¡æœ‰ä¸ºå…¶åˆ†é…å†…å­˜ç©ºé—´ã€‚

ç„¶åï¼Œé€šè¿‡ä½¿ç”¨`allocate`å…³é”®å­—åŠ¨æ€åœ°ä¸ºæ•°ç»„åˆ†é…å†…å­˜ç©ºé—´ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„å¤§å°æ¥ç¡®å®šæ•°ç»„çš„å¤§å°ã€‚

æ¥ä¸‹æ¥ï¼Œä½¿ç”¨å¾ªç¯ç»“æ„åˆå§‹åŒ–æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†å…¶è®¾ç½®ä¸ºæ•°ç»„ç´¢å¼•å€¼ã€‚

ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨å¾ªç¯ç»“æ„è¾“å‡ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ã€‚

æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`deallocate`å…³é”®å­—é‡Šæ”¾æ•°ç»„çš„å†…å­˜ç©ºé—´ï¼Œä»¥ä¾¿åœ¨ç¨‹åºæ‰§è¡Œå®Œæ¯•åé‡Šæ”¾å†…å­˜ã€‚

é€šè¿‡åŠ¨æ€æ•°ç»„ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶æ ¹æ®éœ€è¦åŠ¨æ€åœ°åˆ†é…å’Œç®¡ç†æ•°ç»„çš„å†…å­˜ç©ºé—´ï¼Œä½¿ç¨‹åºæ›´åŠ çµæ´»å’Œå¯æ‰©å±•ã€‚

