---
authors:
    name: BUAAer-xing
    title: 北航HPC硕士生
    url: https://github.com/BUAAer-xing
    image_url: https://cdn.jsdelivr.net/gh/NEUQer-xing/Markdown_images@master/images-2/icon.png
---

# 共轭梯度法

## 概要


笔记文章大致来源：“**CG is the most popular iterative method for solving large systems of linear equations.**” ([pdf](zotero://open-pdf/library/items/WD6AWYES?page=7&annotation=8B2B54LS))

**共轭梯度法**是求解**线性方程稀疏系统**最突出的迭代方法。迭代的共轭梯度法比较适合用于**稀疏矩阵**，如果矩阵A是稠密矩阵，最好的方法是对矩阵A进行因式分解然后通过backsubstitution方法再去解方程。

所研究的方法——最陡下降法和共轭梯度法——是根据**最小化问题**来开发和直观理解的，而不是根据交叉超平面。

所要求解的问题是$Ax=b$ 问题（A矩阵是对称而且是正定的），当$x$的维度为2维时，它可以形象的表示为两条直线的交点。如下图所示：

![image.png|center|500](https://cdn.jsdelivr.net/gh/NEUQer-xing/Markdown_images@master/images-2/20230913104356.png)

如果直接去求解的话，就是$x=A^{-1}b$，也就是交叉超平面的解决方法，但是通常情况下，$A^{-1}$ 是比较难以求得的，所以需要通过一定的转换，从而可以实现迭代求解，也就是利用--最速下降法或共轭梯度法去求解。

它们的基本原理如下：假设一个函数：$$f(x)=\frac{1}{2} x^{T} A x-b^{T} x+c$$
它的函数图像如下所示：

![image.png|center|500](https://cdn.jsdelivr.net/gh/NEUQer-xing/Markdown_images@master/images-2/20230913104831.png)

画出该图像的等高线以及梯度方向如下图所示：

![image.png|center|800](https://cdn.jsdelivr.net/gh/NEUQer-xing/Markdown_images@master/images-2/20230913105616.png)

梯度方向是上升最快的方向，也是下降最快的反方向。**特别的，当下降到最低点时，函数的梯度为0**。

通过利用这个性质，我们就可以将上述解方程的问题，转化为求解某个函数fx的最小值问题，从而更加便于计算和求解。

利用向量的求导方法对函数$f(x)$ 进行求导使得导数等于0，可得到$Ax=b$ ，如下所示：
（注：向量的求导方法[[矩阵的求导运算]])


$$

\begin{split}
f(x)&=\frac{1}{2} x^{T} A x-b^{T} x+c
\\
{f(x)}' &=\frac{1}{2} (A+A^T)x-b
\\
beca&use \ A \ is \ symmetric \ A=A^T
\\
{f(x)}' &=Ax-b
\\
{f(x)}' &=0
\\
Ax &= b
\end{split}

$$

通过上述转化，可以知道，只要找到使得函数$f(x)$最小的取值$x$就相当于找到了方程式$Ax=b$的解。

而找最小值的方法，就是下面的最速下降法和共轭梯度法。

## 最速下降法

### 基本思想

最速下降法（Steepest Descent Method）是用于求解无约束优化问题的最小值。它是一种迭代算法，通过在**每一步选择梯度方向的负方向来进行搜索**，以逐步接近最小值。

最速下降法的基本思想是从任意初始点开始，沿着当前点梯度的反方向进行迭代更新，直到达到某个终止条件。
（❗️注意：这里任意一点$x_{(i)}$梯度的反方向，如果是上面提到的式子，则可以得到为：$-{f(x_{(i)})}'=b-Ax_{(i)}$ ）

在每一步迭代中，最速下降法计算当前点的梯度（即目标函数在该点处的导数），然后朝着梯度的负方向进行移动，以期望在下一步迭代中找到更小的目标函数值。

这个过程类似于在目标函数的曲面上沿着最陡峭的下坡方向下降。

### 一些定义

- $e_{(i)}=x_{(i)}-x$ : (error)，$e_{(i)}$是一个向量，用来表示当前点的$x_{(i)}$与正确取得最小值点的$x$值的差距。
- $r_{(i)}$ : (residual)可以表示的含义有很多，根据表达式的不同，可以分为三种： ^7dd8bf
	- $r_{(i)}=b-Ax_{(i)}$ :这个表示该点的$x_{(i)}$的值和矩阵$A$$进行相乘后，取得的值与值$b$的差距。
	- $r_{(i)}=-Ae_{(i)}$ :
		- $$
			\begin{split}
				\because Ax&=b \ \  and \ \  e_{(i)}=x_{(i)}-x \\
				\therefore -Ae_{(i)}&=-A(x_{(i)}-x)\\
				&=-Ax_{(i)}+Ax \\
				&=b-Ax_{(i)} \\
				&=r_{(i)} \\
				&=-{f(x_{(i)})}'
			\end{split}
		$$
	- $r_{(i)}=-{f(x_{(i)})}'$ : 这个表示该点**梯度的反方向**，也就是下降速度最快的方向。

